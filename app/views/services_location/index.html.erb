<h1>ServicesLocation</h1>
<div class="row">
  <canvas id="myCanvas" width="200" height="100" style="border:1px solid #000000;"></canvas>
<div id="map" class="pull-right"></div>
</div>
<script>


var neighborhoods = new Array();
<% @services.each do | service| %>
neighborhoods.push({lat: <%= service.latitude %>, lng: <%= service.longitude %>});
<% end %>

var markers = [];
var map;

function initMap() {
  map = new google.maps.Map(document.getElementById('map'), {
    zoom: 12,
    center: {lat: 53.347420, lng: -6.253910}
  });
  drop();
}

function drop() {
  clearMarkers();
  for (var i = 0; i < neighborhoods.length; i++) {
    addMarkerWithTimeout(neighborhoods[i], i * 200);
  }
}

function addMarkerWithTimeout(position, timeout) {
  window.setTimeout(function() {
    markers.push(new google.maps.Marker({
      position: position,
      map: map,
      animation: google.maps.Animation.DROP
    }));
  }, timeout);
}

function clearMarkers() {
  for (var i = 0; i < markers.length; i++) {
    markers[i].setMap(null);
  }
  markers = [];
}


</script>

<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCBnG1nz-0s--EBdSX-o9q3ntkxkQDCKVc&callback=initMap">
</script>